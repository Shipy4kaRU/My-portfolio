import { hoverNavLinks } from "./DarkeningNav.js";
import { closeMenu } from "./menu.js";
import { showModalWindow } from "./modalWindow.js";
import { hideModalWindow } from "./modalWindow.js";
//import { toKnowHeaderHeight } from "./navigation.js";
import { scrollTo } from "./navigation.js";
import { PROJECTS_LIST } from "./PROJECTS_LIST.js";
import { addProjectsToHTML } from "./projects.js";
import { stickyNavObserver } from "./navigation.js";
import { showProjects } from "./projects.js";
import { setFeatureSummaryRotate } from "./feature.js";
import { openMenuFeatures } from "./feature.js";
import { changeTheme } from "./changingTheme.js";
import { checkThemeFromLocalStorage } from "./changingTheme.js";

// CONSTANTS

const allProjectsBtn = document.querySelector(".projects__btn--all");
const personProjectsBtn = document.querySelector(".projects__btn--person");
const trainingProjectsBtn = document.querySelector(".projects__btn--training");

// MENU
const main = document.querySelector(".main");
const menu = document.querySelector(".nav__list");
const btnMenu = document.querySelector(".nav__btn-menu");
const header = document.querySelector(".header__container");

(function () {
  main.style.paddingTop = `calc(3em)`;
})();

btnMenu.addEventListener("click", closeMenu);

closeMenu();

// DARKENING NAVIGATION
header.addEventListener("mouseover", hoverNavLinks.bind("0.4"));
header.addEventListener("mouseout", hoverNavLinks.bind("1"));

// SCROLLING TO SECTIONS FROM NAVIGATION

const btnList = document.querySelector(".nav__list");

btnList.addEventListener("click", scrollTo);

// STICKY NAVIGATION
const bioSect = document.querySelector(".bio");

stickyNavObserver.observe(bioSect);

// MODAL WINDOWS
const body = document.querySelector(".body");
const btnDisploma = document.querySelector(".js-education__btn-click");

(function () {
  const html = `<dialog class="modal"><button class="modal__btn"><span class='bisually-hidden'></span></button><img class='modal__img' src='../img/ФСПО.png'></dialog>
  <div class="overlay"></div>`;
  body.insertAdjacentHTML("beforeend", html);
})();

const modalWindow = document.querySelector(".modal");
const overlay = document.querySelector(".overlay");
const btnCloseModal = document.querySelector(".modal__btn");

btnDisploma.addEventListener("click", showModalWindow);
overlay.addEventListener("click", hideModalWindow);
btnCloseModal.addEventListener("click", hideModalWindow);

//PROJECTS_LIST

addProjectsToHTML(PROJECTS_LIST);

const allProjects = document.querySelectorAll(".projects__item");

// SET NUMBER OF PROJECTS INTO THE PROJECTS BTNS

allProjectsBtn.innerHTML = `Все проекты (${allProjects.length})`;
personProjectsBtn.innerHTML = `Личные проекты (${
  document.querySelectorAll(".jsPersonProject").length
})`;
trainingProjectsBtn.innerHTML = `Тренировка навыков (${
  document.querySelectorAll(".jsTrainingProject").length
})`;

// PROJECTS__BUTTONS
const btnsProjects = document.querySelector(".projects__btn-list");

btnsProjects.addEventListener("click", function (e) {
  const btn = e.target;
  if (!btn.closest(".projects__btn")) return;
  if (btn.closest(".projects__btn--all"))
    return showProjects(allProjects, "projects__item");
  if (btn.closest(".projects__btn--person"))
    return showProjects(allProjects, "jsPersonProject");
  if (btn.closest(".projects__btn--training"))
    showProjects(allProjects, "jsTrainingProject");
});

// ROTATE FOR FEATURES

setFeatureSummaryRotate();

// OPENING FEATURES

const featureBtns = document.querySelectorAll(".feature__button");

featureBtns.forEach((btn) => btn.addEventListener("click", openMenuFeatures));

// CHANGING THEME
checkThemeFromLocalStorage();
const btnsNavList = document.querySelector(".nav__btn-wrapper");

btnsNavList.addEventListener("click", changeTheme);
